# Getting started

    npm install
    npm start

# Собранная версия
https://e-melnichenko.github.io/iBrush-task/
# Описание
Задание выполнено с использованием своего шаблона сборки (Gulp, Webpack-stream, scss) https://github.com/e-melnichenko/start-build-gulp. Реализована адаптивная верстка, на мобильной версии добавлена резиновая. Поддержка браузеров ie11, firefox, chrome, safary. Для сравнения с макетом используется pixel-glass. Реализована доступность с клавиатуры.
### Пояснения
В макете опечатка в хедере мобильной версии. Оставил для правильного сравнения с макетом.

Изображение react в постах (последняя секция) унифицировано (svg-->jpg), поэтому не совпадает на мобильной версии.

Кастомный скроллбар реализован локально.  

Селект пришлось написать свой - не смог добиться отступа списка на нативном. 


# Сборка

1. В папку *src/assets/img* переместить изображения для html. svg для спрайта поместить в *tmp/icons*.

2. `gulp webp` - добавляет формат webp. `picturefill.js` для поддержки ie включен в   `main.js`.

3. `gulp sprite` - генерирует спрайт. Имя файла становится id: 

          <svg width="10" height="19">
              <use xlink:href="img/sprite.svg#icon-fb"></use>
          </svg>  
    `svg4everybody.js` для поддержки ie уже подключен в `index.html`.

4. `npm start` для разработки или `npm run build` для продакшн сборки (на macOS/Linux в `package.json` заменить `"build": "set NODE_ENV=production && gulp prod"` на `"build": "NODE_ENV=production gulp prod"`).

5. `npm run deploy` заливает страницу на gh-pages.


## Тонкие моменты  

### Стили  
Изображения для стилей хранятся в папках блоков. Функция `resolver` указывает правильные пути для изображений при импорте и проверяет хеширование. Чтобы задача `styles` имела доступ к файлу манифеста, `styles:assets` должна быть уже выполнена.  

### js
Для сигнализации завершения первой сборки используется вызов *callback*. Иначе webpack watch подвешивает сборку. Gulp watch в данной ситуации менее эффективен. Для чанков, динамических импортов и тд требуется настройка публичных путей. В `main.js` добавлен полифил для метода `closest` в ie11.

### html
Должны быть завершены задачи `style`, `webpack` и `assets:images` для чтения имен файлов из манифеста.

### production  
Перед сборкой на продакшн директория `public` очищается. Изображения,  файлы `main.js` и `style.css` кэшируются.

### Оптимизация изображений
 Для наглядности результата  оптимизация производится после написания кода сайта. Задача `images:opt` создает оптимизированные копии изображений с постфиксом **-opt** для проверки. После выявления оптимальных настроек оптимизированные копии изображений удаляются задачей `images:clean:opt`. Для замены оригиналов исключить из потока задачи `images:clean:opt` модуль *rename*.   